<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Money Smart Adventure - Level 2</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            margin: 0;
            padding: 0;
            background: #2c3e50;
            font-family: 'Press Start 2P', monospace;
            overflow: hidden;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        #gameCanvas {
            border: 4px solid #34495e;
            display: block;
            margin: 5px auto;
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 50%, #90EE90 100%);
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            image-rendering: pixelated;
        }

        #ui {
            position: fixed;
            top: 15px;
            left: 15px;
            background: #34495e;
            padding: 12px;
            border: 3px solid #fff;
            box-shadow: 3px 3px 0px #000;
            min-width: 280px;
        }

        #ui::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: #fff;
            z-index: -1;
        }

        #money {
            font-size: 14px;
            color: #f1c40f;
            margin-bottom: 10px;
            text-shadow: 2px 2px 0px #000;
            letter-spacing: 1px;
        }

        #bankBalance {
            font-size: 12px;
            color: #3498db;
            margin-bottom: 8px;
            text-shadow: 2px 2px 0px #000;
            letter-spacing: 1px;
        }

        #objective {
            font-size: 10px;
            color: #ecf0f1;
            max-width: 280px;
            line-height: 16px;
            text-shadow: 2px 2px 0px #000;
        }

        #message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #2c3e50;
            padding: 20px;
            border: 4px solid #fff;
            text-align: center;
            display: none;
            max-width: 450px;
            box-shadow: 4px 4px 0px #000;
            z-index: 1000;
        }

        #message h2 {
            color: #f1c40f;
            font-size: 16px;
            margin: 0 0 15px 0;
            text-shadow: 2px 2px 0px #000;
        }

        #message p {
            color: #ecf0f1;
            font-size: 10px;
            line-height: 16px;
            margin: 15px 0;
            text-shadow: 2px 2px 0px #000;
        }

        #controls {
            position: fixed;
            bottom: 15px;
            left: 15px;
            background: #34495e;
            padding: 10px;
            border: 2px solid #fff;
            box-shadow: 2px 2px 0px #000;
            font-size: 9px;
            color: #ecf0f1;
            text-shadow: 1px 1px 0px #000;
        }

        .btn {
            background: #e74c3c;
            border: 3px solid #fff;
            padding: 10px 18px;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            margin: 8px;
            color: #fff;
            text-shadow: 1px 1px 0px #000;
            box-shadow: 2px 2px 0px #000;
            transition: none;
        }

        .btn:hover {
            background: #c0392b;
            box-shadow: 1px 1px 0px #000;
            transform: translate(1px, 1px);
        }

        .btn:active {
            box-shadow: none;
            transform: translate(2px, 2px);
        }

        #healthBar {
            position: fixed;
            top: 15px;
            right: 15px;
            background: #34495e;
            padding: 10px;
            border: 2px solid #fff;
            box-shadow: 2px 2px 0px #000;
        }

        #progressBar {
            width: 120px;
            height: 12px;
            background: #2c3e50;
            border: 2px solid #fff;
            margin-top: 5px;
        }

        #progressFill {
            height: 100%;
            background: #27ae60;
            width: 20%;
            transition: width 0.3s ease;
        }

        #levelSelect {
            position: fixed;
            top: 15px;
            right: 200px;
            background: #34495e;
            padding: 8px;
            border: 2px solid #fff;
            box-shadow: 2px 2px 0px #000;
        }

        .level-btn {
            background: #9b59b6;
            border: 2px solid #fff;
            padding: 5px 10px;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            font-size: 8px;
            margin: 2px;
            color: #fff;
            text-shadow: 1px 1px 0px #000;
            box-shadow: 1px 1px 0px #000;
        }

        .level-btn:hover {
            background: #8e44ad;
        }

        .level-btn.active {
            background: #e67e22;
        }
    </style>
</head>
<body>
    <div id="ui">
        <div id="money">CASH: AED 0</div>
        <div id="bankBalance">BANK: AED 0</div>
        <div id="objective">GOAL: RECEIVE BIRTHDAY MONEY AND DEPOSIT IN BANK!</div>
    </div>

    <div id="healthBar">
        <div style="color: #ecf0f1; font-size: 10px; text-shadow: 1px 1px 0px #000;">LEVEL 2</div>
        <div id="progressBar">
            <div id="progressFill"></div>
        </div>
    </div>

    <div id="levelSelect">
        <button class="level-btn" onclick="loadLevel(1)">LV1</button>
        <button class="level-btn active" onclick="loadLevel(2)">LV2</button>
    </div>

    <div id="controls">
        LEFT/RIGHT ARROWS: MOVE | SPACE: INTERACT
    </div>

    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <div id="message">
        <h2>MONEY SMART ADVENTURE - LEVEL 2!</h2>
        <p>You're now 11 years old! Time to learn about banks, deposits, and withdrawals. Let's start your banking journey!</p>
        <button class="btn" onclick="closeMessage()">START LEVEL 2!</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const messageDiv = document.getElementById('message');
        const moneyDisplay = document.getElementById('money');
        const bankDisplay = document.getElementById('bankBalance');
        const objectiveDisplay = document.getElementById('objective');

        let gameState = {
            money: 0,
            bankBalance: 0,
            hasReceivedGift: false,
            hasDepositedMoney: false,
            atBank: false,
            hasWithdrawn: false,
            gamePhase: 'start', // start, gift, parent, deposit, withdraw, bakery, complete
            messageShown: true
        };

        const player = {
            x: 80,
            y: 450,
            width: 40,
            height: 50,
            speed: 5,
            color: '#FF6B6B'
        };

        const objects = {
            giftBox: { x: 180, y: 460, width: 40, height: 40, active: true },
            parent: { x: 320, y: 440, width: 35, height: 60, active: false },
            bank: { x: 500, y: 380, width: 120, height: 120, active: false },
            bakery: { x: 680, y: 400, width: 100, height: 100, active: false },
            cake: { x: 700, y: 440, width: 30, height: 30, visible: false }
        };

        const keys = {};

        // Event listeners
        document.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            if (e.key === ' ') {
                interact();
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        function loadLevel(level) {
            if (level === 1) {
                window.location.reload(); // Reload to get Level 1 (would need separate file in real implementation)
            }
        }

        function closeMessage() {
            messageDiv.style.display = 'none';
            gameState.messageShown = false;
        }

        function showMessage(title, text, buttonText = 'CONTINUE') {
            messageDiv.innerHTML = `
                <h2>${title}</h2>
                <p>${text}</p>
                <button class="btn" onclick="closeMessage()">${buttonText}</button>
            `;
            messageDiv.style.display = 'block';
            gameState.messageShown = true;
        }

        function updateMoney() {
            moneyDisplay.textContent = `CASH: AED ${gameState.money}`;
            bankDisplay.textContent = `BANK: AED ${gameState.bankBalance}`;
        }

        function updateObjective() {
            switch(gameState.gamePhase) {
                case 'start':
                    objectiveDisplay.innerHTML = 'GOAL: GO TO GIFT BOX FOR YOUR 11TH BIRTHDAY MONEY!';
                    document.getElementById('progressFill').style.width = '20%';
                    break;
                case 'gift':
                    objectiveDisplay.innerHTML = 'GOAL: ASK YOUR PARENT TO HELP YOU BANK THE MONEY!';
                    document.getElementById('progressFill').style.width = '35%';
                    break;
                case 'parent':
                    objectiveDisplay.innerHTML = 'GOAL: GO TO THE BANK TO DEPOSIT YOUR MONEY!';
                    document.getElementById('progressFill').style.width = '50%';
                    break;
                case 'deposit':
                    objectiveDisplay.innerHTML = 'GOAL: WITHDRAW AED 8 TO BUY CAKE FOR MOM!';
                    document.getElementById('progressFill').style.width = '70%';
                    break;
                case 'withdraw':
                    objectiveDisplay.innerHTML = 'GOAL: GO TO BAKERY TO BUY CAKE FOR MOM!';
                    document.getElementById('progressFill').style.width = '85%';
                    break;
                case 'bakery':
                    objectiveDisplay.innerHTML = 'GOAL: PRESS SPACE TO BUY CAKE FOR AED 8!';
                    document.getElementById('progressFill').style.width = '95%';
                    break;
                case 'complete':
                    objectiveDisplay.innerHTML = 'LEVEL COMPLETE! YOU LEARNED BANKING BASICS!';
                    document.getElementById('progressFill').style.width = '100%';
                    document.getElementById('progressFill').style.background = '#f1c40f';
                    break;
            }
        }

        function interact() {
            if (gameState.messageShown) return;

            const playerCenter = { x: player.x + player.width/2, y: player.y + player.height/2 };

            // Check gift box interaction
            if (gameState.gamePhase === 'start' && 
                isNear(playerCenter, objects.giftBox) && objects.giftBox.active) {
                gameState.money = 12;
                gameState.hasReceivedGift = true;
                gameState.gamePhase = 'gift';
                objects.giftBox.active = false;
                objects.parent.active = true;
                updateMoney();
                updateObjective();
                showMessage('11TH BIRTHDAY!', 'Happy Birthday! You received AED 12 this year! You\'re getting older and learning more about money management.');
            }

            // Check parent interaction
            if (gameState.gamePhase === 'gift' && 
                isNear(playerCenter, objects.parent) && objects.parent.active) {
                gameState.gamePhase = 'parent';
                objects.parent.active = false;
                objects.bank.active = true;
                updateObjective();
                showMessage('SMART DECISION!', 'Your parent explains that banks keep money safe and can even help it grow! They will help you open your first bank account.');
            }

            // Check bank deposit interaction
            if (gameState.gamePhase === 'parent' && 
                isNear(playerCenter, objects.bank) && objects.bank.active) {
                gameState.bankBalance = gameState.money;
                gameState.money = 0;
                gameState.hasDepositedMoney = true;
                gameState.gamePhase = 'deposit';
                updateMoney();
                updateObjective();
                showMessage('FIRST DEPOSIT!', 'Great! You deposited AED 12 in the bank. Your money is now safe and secure. Banks keep detailed records of your money.');
            }

            // Check bank withdrawal interaction
            if (gameState.gamePhase === 'deposit' && 
                isNear(playerCenter, objects.bank)) {
                if (gameState.bankBalance >= 8) {
                    gameState.bankBalance -= 8;
                    gameState.money = 8;
                    gameState.hasWithdrawn = true;
                    gameState.gamePhase = 'withdraw';
                    objects.bakery.active = true;
                    objects.cake.visible = true;
                    updateMoney();
                    updateObjective();
                    showMessage('WITHDRAWAL SUCCESS!', 'You withdrew AED 8 for your mom\'s cake. You still have AED 4 safely stored in the bank. Smart money management!');
                }
            }

            // Check bakery interaction
            if (gameState.gamePhase === 'withdraw' && 
                isNear(playerCenter, objects.bakery) && objects.bakery.active) {
                gameState.gamePhase = 'bakery';
                updateObjective();
                showMessage('WELCOME TO BAKERY!', 'The birthday cake costs AED 8. Perfect! You have exactly that amount from your bank withdrawal.');
            }

            // Buy cake
            if (gameState.gamePhase === 'bakery' && 
                isNear(playerCenter, objects.cake) && objects.cake.visible) {
                if (gameState.money >= 8) {
                    gameState.money -= 8;
                    gameState.gamePhase = 'complete';
                    objects.cake.visible = false;
                    updateMoney();
                    updateObjective();
                    showMessage('PERFECT PURCHASE!', 'You bought a beautiful cake for your mom! You learned about deposits, withdrawals, and still have AED 4 in the bank for future needs!', 'LEVEL 2 COMPLETE!');
                }
            }
        }

        function isNear(pos1, obj) {
            const distance = Math.sqrt(
                Math.pow(pos1.x - (obj.x + obj.width/2), 2) + 
                Math.pow(pos1.y - (obj.y + obj.height/2), 2)
            );
            return distance < 70;
        }

        function updatePlayer() {
            if (gameState.messageShown) return;

            if (keys['ArrowLeft'] && player.x > 0) {
                player.x -= player.speed;
            }
            if (keys['ArrowRight'] && player.x < canvas.width - player.width) {
                player.x += player.speed;
            }
        }

        function drawGround() {
            ctx.fillStyle = '#8FBC8F';
            ctx.fillRect(0, 500, canvas.width, 100);
            
            // Ground pattern
            ctx.fillStyle = '#228B22';
            for (let i = 0; i < canvas.width; i += 40) {
                ctx.fillRect(i, 500, 20, 100);
            }
        }

        function drawPlayer() {
            // Player body (slightly taller for age 11)
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);
            
            // Player head
            ctx.fillStyle = '#FFDBAC';
            ctx.beginPath();
            ctx.arc(player.x + player.width/2, player.y + 10, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Player eyes
            ctx.fillStyle = '#000';
            ctx.fillRect(player.x + player.width/2 - 8, player.y + 5, 3, 3);
            ctx.fillRect(player.x + player.width/2 + 5, player.y + 5, 3, 3);
            
            // Player smile
            ctx.beginPath();
            ctx.arc(player.x + player.width/2, player.y + 12, 8, 0, Math.PI);
            ctx.stroke();
        }

        function drawObjects() {
            // Gift box
            if (objects.giftBox.active) {
                ctx.fillStyle = '#FFD700';
                ctx.fillRect(objects.giftBox.x, objects.giftBox.y, objects.giftBox.width, objects.giftBox.height);
                ctx.fillStyle = '#FF4500';
                ctx.fillRect(objects.giftBox.x + 15, objects.giftBox.y, 10, objects.giftBox.height);
                ctx.fillRect(objects.giftBox.x, objects.giftBox.y + 15, objects.giftBox.width, 10);
                
                ctx.fillStyle = '#000';
                ctx.font = '12px Arial';
                ctx.fillText('11th Birthday Gift!', objects.giftBox.x - 15, objects.giftBox.y - 10);
            }

            // Parent
            if (objects.parent.active || gameState.gamePhase === 'parent') {
                ctx.fillStyle = '#4169E1';
                ctx.fillRect(objects.parent.x, objects.parent.y, objects.parent.width, objects.parent.height);
                
                // Parent head
                ctx.fillStyle = '#FFDBAC';
                ctx.beginPath();
                ctx.arc(objects.parent.x + objects.parent.width/2, objects.parent.y + 10, 12, 0, Math.PI * 2);
                ctx.fill();
                
                // Parent hair
                ctx.fillStyle = '#8B4513';
                ctx.beginPath();
                ctx.arc(objects.parent.x + objects.parent.width/2, objects.parent.y + 5, 15, Math.PI, 0);
                ctx.fill();
                
                if (objects.parent.active) {
                    ctx.fillStyle = '#000';
                    ctx.font = '10px Arial';
                    ctx.fillText('Parent', objects.parent.x - 5, objects.parent.y - 10);
                }
            }

            // Bank
            if (objects.bank.active || gameState.hasDepositedMoney) {
                const bankX = objects.bank.x;
                const bankY = objects.bank.y;
                
                // Bank building
                ctx.fillStyle = '#708090';
                ctx.fillRect(bankX, bankY, objects.bank.width, objects.bank.height);
                
                // Bank pillars
                ctx.fillStyle = '#F5F5F5';
                ctx.fillRect(bankX + 10, bankY + 20, 15, objects.bank.height - 20);
                ctx.fillRect(bankX + 35, bankY + 20, 15, objects.bank.height - 20);
                ctx.fillRect(bankX + 60, bankY + 20, 15, objects.bank.height - 20);
                ctx.fillRect(bankX + 85, bankY + 20, 15, objects.bank.height - 20);
                
                // Bank roof
                ctx.fillStyle = '#2F4F4F';
                ctx.fillRect(bankX - 5, bankY, objects.bank.width + 10, 20);
                
                // Bank sign
                ctx.fillStyle = '#FFD700';
                ctx.fillRect(bankX + 20, bankY + 5, 80, 10);
                ctx.fillStyle = '#000';
                ctx.font = 'bold 10px Arial';
                ctx.fillText('CENTRAL BANK', bankX + 30, bankY + 13);
                
                // Bank door
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(bankX + 50, bankY + 80, 20, 40);
                
                // Dollar sign
                ctx.fillStyle = '#00FF00';
                ctx.font = 'bold 20px Arial';
                ctx.fillText('$', bankX + 55, bankY + 50);
            }

            // Bakery
            if (objects.bakery.active || gameState.gamePhase === 'bakery' || gameState.gamePhase === 'complete') {
                const bakeryX = objects.bakery.x;
                const bakeryY = objects.bakery.y;
                
                // Bakery building
                ctx.fillStyle = '#DEB887';
                ctx.fillRect(bakeryX, bakeryY + 20, objects.bakery.width, objects.bakery.height - 20);
                
                // Bakery awning
                ctx.fillStyle = '#FF69B4';
                ctx.fillRect(bakeryX - 5, bakeryY + 15, objects.bakery.width + 10, 8);
                
                // Striped awning
                ctx.fillStyle = '#FFB6C1';
                ctx.fillRect(bakeryX - 8, bakeryY + 23, objects.bakery.width + 16, 15);
                
                // Awning stripes
                ctx.fillStyle = '#FF1493';
                for (let i = 0; i < 6; i++) {
                    ctx.fillRect(bakeryX - 8 + (i * 20), bakeryY + 23, 10, 15);
                }
                
                // Bakery sign
                ctx.fillStyle = '#F5DEB3';
                ctx.fillRect(bakeryX + 20, bakeryY, 60, 15);
                ctx.strokeStyle = '#8B4513';
                ctx.lineWidth = 2;
                ctx.strokeRect(bakeryX + 20, bakeryY, 60, 15);
                
                ctx.fillStyle = '#8B0000';
                ctx.font = 'bold 10px Arial';
                ctx.fillText('BAKERY', bakeryX + 35, bakeryY + 11);
                
                // Bakery window
                ctx.fillStyle = '#87CEEB';
                ctx.fillRect(bakeryX + 15, bakeryY + 35, 30, 25);
                ctx.strokeStyle = '#4169E1';
                ctx.lineWidth = 2;
                ctx.strokeRect(bakeryX + 15, bakeryY + 35, 30, 25);
                
                // Bakery door
                ctx.fillStyle = '#654321';
                ctx.fillRect(bakeryX + 55, bakeryY + 45, 20, 35);
            }

            // Cake
            if (objects.cake.visible) {
                ctx.fillStyle = '#FFE4B5';
                ctx.fillRect(objects.cake.x, objects.cake.y + 10, objects.cake.width, 20);
                
                // Cake layers
                ctx.fillStyle = '#F0E68C';
                ctx.fillRect(objects.cake.x + 2, objects.cake.y + 8, objects.cake.width - 4, 8);
                ctx.fillRect(objects.cake.x + 4, objects.cake.y + 5, objects.cake.width - 8, 8);
                
                // Candles
                ctx.fillStyle = '#FF6347';
                ctx.fillRect(objects.cake.x + 8, objects.cake.y, 2, 10);
                ctx.fillRect(objects.cake.x + 15, objects.cake.y, 2, 10);
                ctx.fillRect(objects.cake.x + 22, objects.cake.y, 2, 10);
                
                // Flames
                ctx.fillStyle = '#FFA500';
                ctx.fillRect(objects.cake.x + 8, objects.cake.y - 3, 2, 3);
                ctx.fillRect(objects.cake.x + 15, objects.cake.y - 3, 2, 3);
                ctx.fillRect(objects.cake.x + 22, objects.cake.y - 3, 2, 3);
                
                // Price tag
                ctx.fillStyle = '#FFD700';
                ctx.fillRect(objects.cake.x + 25, objects.cake.y - 5, 30, 15);
                ctx.fillStyle = '#000';
                ctx.font = '8px Arial';
                ctx.fillText('AED 8', objects.cake.x + 28, objects.cake.y + 3);
            }
        }

        function drawInteractionPrompts() {
            const playerCenter = { x: player.x + player.width/2, y: player.y + player.height/2 };
            
            ctx.fillStyle = '#000000';
            ctx.font = 'bold 14px Arial';
            
            if (gameState.gamePhase === 'start' && isNear(playerCenter, objects.giftBox)) {
                ctx.fillText('Press SPACE to open gift!', player.x - 30, player.y - 25);
            }
            if (gameState.gamePhase === 'gift' && isNear(playerCenter, objects.parent)) {
                ctx.fillText('Press SPACE to ask parent!', player.x - 35, player.y - 25);
            }
            if (gameState.gamePhase === 'parent' && isNear(playerCenter, objects.bank)) {
                ctx.fillText('Press SPACE to deposit!', player.x - 30, player.y - 25);
            }
            if (gameState.gamePhase === 'deposit' && isNear(playerCenter, objects.bank)) {
                ctx.fillText('Press SPACE to withdraw!', player.x - 35, player.y - 25);
            }
            if (gameState.gamePhase === 'bakery' && isNear(playerCenter, objects.cake)) {
                ctx.fillText('Press SPACE to buy cake!', player.x - 35, player.y - 25);
            }
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            drawGround();
            drawObjects();
            updatePlayer();
            drawPlayer();
            drawInteractionPrompts();
            
            requestAnimationFrame(gameLoop);
        }

        // Initialize game
        updateMoney();
        updateObjective();
        messageDiv.style.display = 'block';
        gameLoop();
    </script>
</body>
</html>